<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Lab5</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>
    <script src="paths.js"></script> 

</head>
<body>
    <div id="mapD" style="width: 800px; height: 600px; margin: auto; Border: 1px solid #AAA"></div>
    <script>
        var map = L.map('mapD', { center: [47.655548, -122.303200], zoom: 16 });
        // var map = L.map('mapD').setView([35.10418, -106.62987], zoom: 10);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        // add an empty layer to populate later
        /*
        var myLayer = L.geoJSON().addTo(map);
        myLayer.addData(geojsonFeature);
        */

       var homeMarker = L.marker([47.6715986, -122.3070282], { draggable: false }).addTo(map).bindPopup("<b>Home!</b>").openPopup();

        map.setView([47.655548, -122.303200], 13,{ animation: true });

        // Comfort zones on UW campus
        var myZoneUW = {
            "type": "FeatureCollection", "features": [{
                "type": "Feature", "properties": {
                    "name": "Suzzalo Reading Room", "PopupContents": "Books and quiet", "Indoor": "Yes"
                },
                "geometry": { "type": "Polygon", "coordinates": [[[-122.308524, 47.655568], [-122.308566, 47.655538], [-122.308613, 47.655517], [-122.308669, 47.655525], [-122.308731, 47.655581], [-122.308583, 47.656111], [-122.308502, 47.656165], [-122.30844, 47.656157], [-122.308392, 47.656095]]] }
            },
            {
                "type": "Feature", "properties": {
                    "name": "Medicinal Herb Garden", "PopupContents": "Sun-loving plants", "Indoor": "No"
                },
                "geometry": { "type": "Polygon", "coordinates": [[[-122.30838, 47.652386], [-122.308178, 47.652377], [-122.308207, 47.652171], [-122.308326, 47.652151], [-122.308435, 47.652212], [-122.308401, 47.652392], [-122.30838, 47.652386]]] }
            },
            {
                "type": "Feature", "properties": {
                    "name": "Northwest Rose Garden", "PopupContents": "Roses near the fountain", "Indoor": "No"
                },
                "geometry": { "type": "Polygon", "coordinates": [[[-122.30828, 47.653929], [-122.308304, 47.653858], [-122.308327, 47.653784], [-122.308507, 47.653957], [-122.308184, 47.654082], [-122.30828, 47.653929]]] }
                },
            {

               "type": "Feature", "properties": {
                        "name": "3rd Place", "PopupContents": "Books and pub", "Indoor": "yes"
                    },
               "geometry": { "type": "Point", "coordinates": [-122.30828, 47.653929]}
               }

            ]

        }

        var geojsonLayer = L.geoJSON(myZoneUW, {
            style: styleFunction, onEachFeature: happenHover
        }).addTo(map);

        //var parksLayer = L.geoJSON(parks, { style: defaultStyle, onEachFeature: happenHover }).addTo(map);
        var pathsLayer = L.geoJSON(paths, { style: pathStyle, onEachFeature: addDesc });

        // style color
        
        // Indoors vs outdoors
        /*
        function styleFunction(feature) {
            switch (feature.properties.Indoor) {
            case "Yes": return {color:"red"};
            case "No": return {color:"purple"};
            }
        }
        */

        // all purple or green
        function styleFunction() { return { color: "green" } }
        function newStyle(e) { e.target.setStyle({ color: "blue" }); }
        function oldStyle() { geojsonLayer.setStyle({ color: "green" }); }
        function clickStyle(e) { e.target.setStyle({ color: "red" });  }

        
        // hover function
        function happenHover(feature, layer) {
            layer.on('click', function (e) { clickStyle(e); });
            layer.bindPopup('<b>' + feature.properties.name + '</b>' + '<br>' + feature.properties.PopupContents, { closeButton: false });
            layer.on('mouseover', function () { layer.openPopup(); });
            layer.on('mouseover', function (e) { newStyle(e) });
            layer.on('mouseout', oldStyle);
            layer.on('mouseout', function () { layer.closePopup(); });
            
        }

        // click function
        function happenClick(feature, layer) {
            layer.on('click', function (e) { clickStyle(e); });
        }



        /*var geojsonLayer = L.geoJSON(myZoneUW, {
            style: styleFunction, onEachFeature: function(feature, layer){
            layer.bindPopup(feature.properties.name);}}).addTo(map);
        */



        // hover
        // geojsonLayer.on('mouseover', newStyle);
        // geojsonLayer.on('mouseout', oldStyle);

        function pathStyle(feature) {
            return {
                fillColor: feature.properties.fill,
                weight: 2,
                opacity: 1,
                color: feature.properties.stroke,
                fillOpacity: 0.5,
                dashArray: "5,5"
            };
        }

        function plantStyle(feature) {
            return {
                "marker-color": "#008000",
                "marker-size": "medium",
                "marker-symbol": "garden"
            }

        }

        function walk() {
            pathsLayer.addTo(map);
            //map.removeLayer(parksLayer);
        }

        function conditions() {
            parksLayer.addTo(map);
            map.removeLayer(pathsLayer);
        }


        



    </script>
    <p><center>
           <button onclick="walk()">Show me some pleasant rambles.</button>    
    </center></p>
</body>
</html>